# Plymouth hooks for /lib/init/splash-functions-base

splash_running()
{
	if [ -x /bin/plymouth ] && plymouth --ping; then
		return 0
	fi
	return 1
}

splash_stop()
{
	splash_running || return 0

	#plymouth --hide-splash
	plymouth --quit
	plymouth --wait
	return 0
}

splash_start()
{
	if splash_running; then
		return 0
	elif [ ! -x /sbin/plymouthd ]; then
		return 1
	fi

	/sbin/plymouthd || return 1
	return 0
}

custom_splash_progress()
{
	splash_running || return 0
	/bin/plymouth --update "$1" || return 1
	return 0
}

#FIXME: PORTME
splash_start_indefinite()
{
	splash_running || return 0
	# TIMOUT 0 is not indefinite
	/sbin/usplash_write "TIMEOUT 600" || return 1
	/sbin/usplash_write "PULSATE" || return 1
	return 0
}

splash_stop_indefinite()
{
	splash_running || return 0
	/sbin/usplash_write "TIMEOUT 15" || return 1
	return 0
}

splash_user_input()
{
	splash_running || return 1
	[ -p /dev/.initramfs/usplash_outfifo ] || return 1

	case "$2" in
		regular)
		/sbin/usplash_write "INPUT $1" || return 1
		;;
		password)
		/sbin/usplash_write "INPUTQUIET $1" || return 1
		;;
		enter)
		/sbin/usplash_write "INPUTENTER $1" || return 1
		;;
		*)
		return 1
		;;
	esac
	cat /dev/.initramfs/usplash_outfifo 2> /dev/null || return 1
	return 0
}
